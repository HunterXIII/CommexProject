{% extends 'base.html' %}
{% block title %}Чат с {{ companion.username }}{% endblock %}

{% block extra_css %}
<style>
    .messages {
        height: 65vh;
        overflow-y: auto;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
    }

    .msg {
        max-width: 70%;
        padding: 10px 15px;
        border-radius: 18px;
        margin-bottom: 10px;
    }

    .my {
        background: #0d6efd;
        color: white;
        margin-left: auto;
    }

    .their {
        background: #e9ecef;
        margin-right: auto;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Чат с <strong>{{ companion.username }}</strong></h3>
    <a href="{% url 'chat_list' %}" class="btn btn-secondary">Назад</a>
</div>

<div class="messages mb-3" id="messages">
    {% for msg in messages %}
    {% include 'chats/components/message_bubble.html' with message=msg %}
    {% endfor %}
</div>

<form method="post" class="d-flex">
    {% csrf_token %}
    <input name="content" class="form-control me-2" placeholder="Введите сообщение..." required>
    <button type="submit" class="btn btn-primary">Отправить</button>
</form>
{% endblock %}

{% block extra_js %}
<script>
    const msgDiv = document.getElementById('messages');
    msgDiv.scrollTop = msgDiv.scrollHeight;
</script>
{% endblock %}